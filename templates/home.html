{% extends 'basewithnav.html' %} {% block title %}Home{% endblock %} {% block
body %}
<div class="container">
  <div class="row mt-5">
    <!-- Welcome and Request Book section -->
    <div
      class="col-md-6 d-flex flex-column justify-content-start align-items-start"
    >
      <!-- Welcome section -->
      <div>
        <h1>Welcome to the Library</h1>
        <p>
          This is your personal library dashboard. Here you can manage your
          borrowed books and explore new ones.
        </p>
      </div>

      <!-- Request book section -->
      <div class="mt-5">
        <h2>Request a Book</h2>
        <p>Explore our collection and request a book to borrow.</p>
        <a href="{{ url_for('render.books') }}" class="btn btn-primary"
          >Request Book</a
        >
      </div>

      <!-- Continue Reading section -->
      <div class="mt-5">
        <h2>Continue Reading</h2>
        <p>You were reading:</p>
        <p>{{ last_read_book }}</p>
        <a href="#" class="btn btn-primary">Continue</a>
      </div>
    </div>

    <!-- Books in Hand section -->
    <div class="col-md-6">
      <h2>Books in Hand</h2>
      <p>Here are the books you currently have borrowed:</p>
      <table class="table table-bordered">
        <thead>
          <tr>
            <th>Book ID</th>
            <th>Title</th>
            <th>Author</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for book in borrowed_books %}
          <tr>
            <td>{{ book[0] }}</td>
            <td>{{ book[1] }}</td>
            <td>{{ book[2] }}</td>
            <td>
              <a href="#" class="btn btn-primary">Read</a>
              <a
                href="{{ url_for('endpoints.revoke_book', username=username, book_id=book[0]) }}"
                class="btn btn-danger"
                >Revoke</a
              >
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>

<script>
  function fetchData() {
    fetch(
      `https://127.0.0.1:5000/api/revoke?username=${username}&book_id=${book[0]}`,
      {
        method: "DELETE",
      }
    )
      .then((response) => {
        if (response.status === 200) {
          window.location.href = "/";
        }
      })
      .catch((error) => {
        console.error("Error:", error);
      });
  }
</script>
{% endblock %}
